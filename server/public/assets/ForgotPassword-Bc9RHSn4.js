import{p as y,r as d,j as e,O as j,T as v,D as P,G as p}from"./index-JLmx17Az.js";import{m as S}from"./proxy-dBKeKQzG.js";const T=()=>{const u=y(),[m,h]=d.useState(1),[x,l]=d.useState(""),[o,i]=d.useState(!1),[s,b]=d.useState({email:"",otp:"",newPassword:"",confirmPassword:""}),c=a=>{b({...s,[a.target.name]:a.target.value})},w=async a=>{var r,t;a.preventDefault(),l(""),i(!0);try{(await p.post("http://localhost:3000/api/forgot-password",{email:s.email})).data&&h(2)}catch(n){l(((t=(r=n.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to send OTP")}finally{i(!1)}},f=async a=>{var r,t;a.preventDefault(),l(""),i(!0);try{(await p.post("http://localhost:3000/api/verify-otp",{email:s.email,otp:s.otp})).data&&h(3)}catch(n){l(((t=(r=n.response)==null?void 0:r.data)==null?void 0:t.message)||"Invalid OTP")}finally{i(!1)}},N=async a=>{var r,t;if(a.preventDefault(),l(""),s.newPassword!==s.confirmPassword){l("Passwords do not match");return}i(!0);try{(await p.post("http://localhost:3000/api/reset-password",{email:s.email,otp:s.otp,newPassword:s.newPassword})).data&&u("/login")}catch(n){l(((t=(r=n.response)==null?void 0:r.data)==null?void 0:t.message)||"Failed to reset password")}finally{i(!1)}},g=()=>{switch(m){case 1:return e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Email Address"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx(P,{})}),e.jsx("input",{type:"email",className:"form-control",name:"email",value:s.email,onChange:c,placeholder:"Enter your email",required:!0})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Sending OTP..."]}):"Send OTP"})]});case 2:return e.jsxs("form",{onSubmit:f,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Enter OTP"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx(v,{})}),e.jsx("input",{type:"text",className:"form-control",name:"otp",value:s.otp,onChange:c,placeholder:"Enter OTP",required:!0})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Verifying..."]}):"Verify OTP"})]});case 3:return e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"New Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx(j,{})}),e.jsx("input",{type:"password",className:"form-control",name:"newPassword",value:s.newPassword,onChange:c,placeholder:"Enter new password",required:!0})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"form-label",children:"Confirm Password"}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx(j,{})}),e.jsx("input",{type:"password",className:"form-control",name:"confirmPassword",value:s.confirmPassword,onChange:c,placeholder:"Confirm new password",required:!0})]})]}),e.jsx("button",{type:"submit",className:"btn btn-primary w-100",disabled:o,children:o?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status"}),"Resetting..."]}):"Reset Password"})]});default:return null}};return e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},className:"min-vh-100 d-flex align-items-center justify-content-center",children:e.jsx("div",{className:"container",children:e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-md-6 col-lg-4",children:e.jsx("div",{className:"card shadow",children:e.jsxs("div",{className:"card-body p-5",children:[e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-primary",children:"Reset Password"}),e.jsx("p",{className:"text-muted",children:m===1?"Enter your email to receive OTP":m===2?"Enter the OTP sent to your email":"Enter your new password"})]}),x&&e.jsx("div",{className:"alert alert-danger",role:"alert",children:x}),g(),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{className:"btn btn-link",onClick:()=>u("/login"),children:"Back to Login"})})]})})})})})})};export{T as default};
